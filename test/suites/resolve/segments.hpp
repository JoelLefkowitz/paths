#ifndef PATHS_SUITES_RESOLVE_SEGMENTS_HPP
#define PATHS_SUITES_RESOLVE_SEGMENTS_HPP

#include <string>
#include <vector>

// cppclean-disable-next-line
#include "../../../src/detect.hpp"

struct SegmentsTestCase {
    std::string              path;
    std::vector<std::string> expected;
};

const std::vector<SegmentsTestCase> common_cases = {
    {"",            {"."}                   },
    {".",           {"."}                   },
    {"..",          {".."}                  },
    {"a",           {"a"}                   },
    {"/",           {}                      },
    {"/.",          {}                      },
    {"/..",         {}                      },
    {"/a",          {"a"}                   },
    {"./",          {"."}                   },
    {"./.",         {"."}                   },
    {"./..",        {".."}                  },
    {"./a",         {"a"}                   },
    {"../",         {".."}                  },
    {"../.",        {".."}                  },
    {"../..",       {"..", ".."}            },
    {"../a",        {"..", "a"}             },
    {"a/",          {"a"}                   },
    {"a/.",         {"a"}                   },
    {"a/..",        {"."}                   },
    {"a/b",         {"a", "b"}              },
    {"//",          {}                      },
    {"//.",         {}                      },
    {"//..",        {}                      },
    {"//a",         {"a"}                   },
    {"/./",         {}                      },
    {"/./.",        {}                      },
    {"/./..",       {}                      },
    {"/./a",        {"a"}                   },
    {"/../",        {}                      },
    {"/../.",       {}                      },
    {"/../..",      {}                      },
    {"/../a",       {"a"}                   },
    {"/a/",         {"a"}                   },
    {"/a/.",        {"a"}                   },
    {"/a/..",       {}                      },
    {"/a/b",        {"a", "b"}              },
    {".//",         {"."}                   },
    {".//.",        {"."}                   },
    {".//..",       {".."}                  },
    {".//a",        {"a"}                   },
    {"././",        {"."}                   },
    {"././.",       {"."}                   },
    {"././..",      {".."}                  },
    {"././a",       {"a"}                   },
    {"./../",       {".."}                  },
    {"./../.",      {".."}                  },
    {"./../..",     {"..", ".."}            },
    {"./../a",      {"..", "a"}             },
    {"./a/",        {"a"}                   },
    {"./a/.",       {"a"}                   },
    {"./a/..",      {"."}                   },
    {"./a/b",       {"a", "b"}              },
    {"..//",        {".."}                  },
    {"..//.",       {".."}                  },
    {"..//..",      {"..", ".."}            },
    {"..//a",       {"..", "a"}             },
    {".././",       {".."}                  },
    {".././.",      {".."}                  },
    {".././..",     {"..", ".."}            },
    {".././a",      {"..", "a"}             },
    {"../../",      {"..", ".."}            },
    {"../../.",     {"..", ".."}            },
    {"../../..",    {"..", "..", ".."}      },
    {"../../a",     {"..", "..", "a"}       },
    {"../a/",       {"..", "a"}             },
    {"../a/.",      {"..", "a"}             },
    {"../a/..",     {".."}                  },
    {"../a/b",      {"..", "a", "b"}        },
    {"a//",         {"a"}                   },
    {"a//.",        {"a"}                   },
    {"a//..",       {"."}                   },
    {"a//b",        {"a", "b"}              },
    {"a/./",        {"a"}                   },
    {"a/./.",       {"a"}                   },
    {"a/./..",      {"."}                   },
    {"a/./b",       {"a", "b"}              },
    {"a/../",       {"."}                   },
    {"a/../.",      {"."}                   },
    {"a/../..",     {".."}                  },
    {"a/../b",      {"b"}                   },
    {"a/b/",        {"a", "b"}              },
    {"a/b/.",       {"a", "b"}              },
    {"a/b/..",      {"a"}                   },
    {"a/b/c",       {"a", "b", "c"}         },
    {"///",         {}                      },
    {"///.",        {}                      },
    {"///..",       {}                      },
    {"///a",        {"a"}                   },
    {"//./",        {}                      },
    {"//./.",       {}                      },
    {"//./..",      {}                      },
    {"//./a",       {"a"}                   },
    {"//../",       {}                      },
    {"//../.",      {}                      },
    {"//../..",     {}                      },
    {"//../a",      {"a"}                   },
    {"//a/",        {"a"}                   },
    {"//a/.",       {"a"}                   },
    {"//a/..",      {}                      },
    {"//a/b",       {"a", "b"}              },
    {"/.//",        {}                      },
    {"/.//.",       {}                      },
    {"/.//..",      {}                      },
    {"/.//a",       {"a"}                   },
    {"/././",       {}                      },
    {"/././.",      {}                      },
    {"/././..",     {}                      },
    {"/././a",      {"a"}                   },
    {"/./../",      {}                      },
    {"/./../.",     {}                      },
    {"/./../..",    {}                      },
    {"/./../a",     {"a"}                   },
    {"/./a/",       {"a"}                   },
    {"/./a/.",      {"a"}                   },
    {"/./a/..",     {}                      },
    {"/./a/b",      {"a", "b"}              },
    {"/..//",       {}                      },
    {"/..//.",      {}                      },
    {"/..//..",     {}                      },
    {"/..//a",      {"a"}                   },
    {"/.././",      {}                      },
    {"/.././.",     {}                      },
    {"/.././..",    {}                      },
    {"/.././a",     {"a"}                   },
    {"/../../",     {}                      },
    {"/../../.",    {}                      },
    {"/../../..",   {}                      },
    {"/../../a",    {"a"}                   },
    {"/../a/",      {"a"}                   },
    {"/../a/.",     {"a"}                   },
    {"/../a/..",    {}                      },
    {"/../a/b",     {"a", "b"}              },
    {"/a//",        {"a"}                   },
    {"/a//.",       {"a"}                   },
    {"/a//..",      {}                      },
    {"/a//b",       {"a", "b"}              },
    {"/a/./",       {"a"}                   },
    {"/a/./.",      {"a"}                   },
    {"/a/./..",     {}                      },
    {"/a/./b",      {"a", "b"}              },
    {"/a/../",      {}                      },
    {"/a/../.",     {}                      },
    {"/a/../..",    {}                      },
    {"/a/../b",     {"b"}                   },
    {"/a/b/",       {"a", "b"}              },
    {"/a/b/.",      {"a", "b"}              },
    {"/a/b/..",     {"a"}                   },
    {"/a/b/c",      {"a", "b", "c"}         },
    {".///",        {"."}                   },
    {".///.",       {"."}                   },
    {".///..",      {".."}                  },
    {".///a",       {"a"}                   },
    {".//./",       {"."}                   },
    {".//./.",      {"."}                   },
    {".//./..",     {".."}                  },
    {".//./a",      {"a"}                   },
    {".//../",      {".."}                  },
    {".//../.",     {".."}                  },
    {".//../..",    {"..", ".."}            },
    {".//../a",     {"..", "a"}             },
    {".//a/",       {"a"}                   },
    {".//a/.",      {"a"}                   },
    {".//a/..",     {"."}                   },
    {".//a/b",      {"a", "b"}              },
    {"././/",       {"."}                   },
    {"././/.",      {"."}                   },
    {"././/..",     {".."}                  },
    {"././/a",      {"a"}                   },
    {"./././",      {"."}                   },
    {"./././.",     {"."}                   },
    {"./././..",    {".."}                  },
    {"./././a",     {"a"}                   },
    {"././../",     {".."}                  },
    {"././../.",    {".."}                  },
    {"././../..",   {"..", ".."}            },
    {"././../a",    {"..", "a"}             },
    {"././a/",      {"a"}                   },
    {"././a/.",     {"a"}                   },
    {"././a/..",    {"."}                   },
    {"././a/b",     {"a", "b"}              },
    {"./..//",      {".."}                  },
    {"./..//.",     {".."}                  },
    {"./..//..",    {"..", ".."}            },
    {"./..//a",     {"..", "a"}             },
    {"./.././",     {".."}                  },
    {"./.././.",    {".."}                  },
    {"./.././..",   {"..", ".."}            },
    {"./.././a",    {"..", "a"}             },
    {"./../../",    {"..", ".."}            },
    {"./../../.",   {"..", ".."}            },
    {"./../../..",  {"..", "..", ".."}      },
    {"./../../a",   {"..", "..", "a"}       },
    {"./../a/",     {"..", "a"}             },
    {"./../a/.",    {"..", "a"}             },
    {"./../a/..",   {".."}                  },
    {"./../a/b",    {"..", "a", "b"}        },
    {"./a//",       {"a"}                   },
    {"./a//.",      {"a"}                   },
    {"./a//..",     {"."}                   },
    {"./a//b",      {"a", "b"}              },
    {"./a/./",      {"a"}                   },
    {"./a/./.",     {"a"}                   },
    {"./a/./..",    {"."}                   },
    {"./a/./b",     {"a", "b"}              },
    {"./a/../",     {"."}                   },
    {"./a/../.",    {"."}                   },
    {"./a/../..",   {".."}                  },
    {"./a/../b",    {"b"}                   },
    {"./a/b/",      {"a", "b"}              },
    {"./a/b/.",     {"a", "b"}              },
    {"./a/b/..",    {"a"}                   },
    {"./a/b/c",     {"a", "b", "c"}         },
    {"..///",       {".."}                  },
    {"..///.",      {".."}                  },
    {"..///..",     {"..", ".."}            },
    {"..///a",      {"..", "a"}             },
    {"..//./",      {".."}                  },
    {"..//./.",     {".."}                  },
    {"..//./..",    {"..", ".."}            },
    {"..//./a",     {"..", "a"}             },
    {"..//../",     {"..", ".."}            },
    {"..//../.",    {"..", ".."}            },
    {"..//../..",   {"..", "..", ".."}      },
    {"..//../a",    {"..", "..", "a"}       },
    {"..//a/",      {"..", "a"}             },
    {"..//a/.",     {"..", "a"}             },
    {"..//a/..",    {".."}                  },
    {"..//a/b",     {"..", "a", "b"}        },
    {".././/",      {".."}                  },
    {".././/.",     {".."}                  },
    {".././/..",    {"..", ".."}            },
    {".././/a",     {"..", "a"}             },
    {"../././",     {".."}                  },
    {"../././.",    {".."}                  },
    {"../././..",   {"..", ".."}            },
    {"../././a",    {"..", "a"}             },
    {".././../",    {"..", ".."}            },
    {".././../.",   {"..", ".."}            },
    {".././../..",  {"..", "..", ".."}      },
    {".././../a",   {"..", "..", "a"}       },
    {".././a/",     {"..", "a"}             },
    {".././a/.",    {"..", "a"}             },
    {".././a/..",   {".."}                  },
    {".././a/b",    {"..", "a", "b"}        },
    {"../..//",     {"..", ".."}            },
    {"../..//.",    {"..", ".."}            },
    {"../..//..",   {"..", "..", ".."}      },
    {"../..//a",    {"..", "..", "a"}       },
    {"../.././",    {"..", ".."}            },
    {"../.././.",   {"..", ".."}            },
    {"../.././..",  {"..", "..", ".."}      },
    {"../.././a",   {"..", "..", "a"}       },
    {"../../../",   {"..", "..", ".."}      },
    {"../../../.",  {"..", "..", ".."}      },
    {"../../../..", {"..", "..", "..", ".."}},
    {"../../../a",  {"..", "..", "..", "a"} },
    {"../../a/",    {"..", "..", "a"}       },
    {"../../a/.",   {"..", "..", "a"}       },
    {"../../a/..",  {"..", ".."}            },
    {"../../a/b",   {"..", "..", "a", "b"}  },
    {"../a//",      {"..", "a"}             },
    {"../a//.",     {"..", "a"}             },
    {"../a//..",    {".."}                  },
    {"../a//b",     {"..", "a", "b"}        },
    {"../a/./",     {"..", "a"}             },
    {"../a/./.",    {"..", "a"}             },
    {"../a/./..",   {".."}                  },
    {"../a/./b",    {"..", "a", "b"}        },
    {"../a/../",    {".."}                  },
    {"../a/../.",   {".."}                  },
    {"../a/../..",  {"..", ".."}            },
    {"../a/../b",   {"..", "b"}             },
    {"../a/b/",     {"..", "a", "b"}        },
    {"../a/b/.",    {"..", "a", "b"}        },
    {"../a/b/..",   {"..", "a"}             },
    {"../a/b/c",    {"..", "a", "b", "c"}   },
    {"a///",        {"a"}                   },
    {"a///.",       {"a"}                   },
    {"a///..",      {"."}                   },
    {"a///b",       {"a", "b"}              },
    {"a//./",       {"a"}                   },
    {"a//./.",      {"a"}                   },
    {"a//./..",     {"."}                   },
    {"a//./b",      {"a", "b"}              },
    {"a//../",      {"."}                   },
    {"a//../.",     {"."}                   },
    {"a//../..",    {".."}                  },
    {"a//../b",     {"b"}                   },
    {"a//b/",       {"a", "b"}              },
    {"a//b/.",      {"a", "b"}              },
    {"a//b/..",     {"a"}                   },
    {"a//b/c",      {"a", "b", "c"}         },
    {"a/.//",       {"a"}                   },
    {"a/.//.",      {"a"}                   },
    {"a/.//..",     {"."}                   },
    {"a/.//b",      {"a", "b"}              },
    {"a/././",      {"a"}                   },
    {"a/././.",     {"a"}                   },
    {"a/././..",    {"."}                   },
    {"a/././b",     {"a", "b"}              },
    {"a/./../",     {"."}                   },
    {"a/./../.",    {"."}                   },
    {"a/./../..",   {".."}                  },
    {"a/./../b",    {"b"}                   },
    {"a/./b/",      {"a", "b"}              },
    {"a/./b/.",     {"a", "b"}              },
    {"a/./b/..",    {"a"}                   },
    {"a/./b/c",     {"a", "b", "c"}         },
    {"a/..//",      {"."}                   },
    {"a/..//.",     {"."}                   },
    {"a/..//..",    {".."}                  },
    {"a/..//b",     {"b"}                   },
    {"a/.././",     {"."}                   },
    {"a/.././.",    {"."}                   },
    {"a/.././..",   {".."}                  },
    {"a/.././b",    {"b"}                   },
    {"a/../../",    {".."}                  },
    {"a/../../.",   {".."}                  },
    {"a/../../..",  {"..", ".."}            },
    {"a/../../b",   {"..", "b"}             },
    {"a/../b/",     {"b"}                   },
    {"a/../b/.",    {"b"}                   },
    {"a/../b/..",   {"."}                   },
    {"a/../b/c",    {"b", "c"}              },
    {"a/b//",       {"a", "b"}              },
    {"a/b//.",      {"a", "b"}              },
    {"a/b//..",     {"a"}                   },
    {"a/b//c",      {"a", "b", "c"}         },
    {"a/b/./",      {"a", "b"}              },
    {"a/b/./.",     {"a", "b"}              },
    {"a/b/./..",    {"a"}                   },
    {"a/b/./c",     {"a", "b", "c"}         },
    {"a/b/../",     {"a"}                   },
    {"a/b/../.",    {"a"}                   },
    {"a/b/../..",   {"."}                   },
    {"a/b/../c",    {"a", "c"}              },
    {"a/b/c/",      {"a", "b", "c"}         },
    {"a/b/c/.",     {"a", "b", "c"}         },
    {"a/b/c/..",    {"a", "b"}              },
    {"a/b/c/d",     {"a", "b", "c", "d"}    },
};

const std::vector<SegmentsTestCase> windows_cases = {
    {"C:/a/b",   {"a", "b"}     },
    {"//a/b/c",  {"c"}          },
    {"///a/b/c", {"a", "b", "c"}},
};

const std::vector<SegmentsTestCase> posix_cases = {
    {"C:/a/b",   {"C:", "a", "b"}},
    {"//a/b/c",  {"a", "b", "c"} },
    {"///a/b/c", {"a", "b", "c"} },
};

const std::vector<SegmentsTestCase> platform_cases = platform::os == platform::Windows ? windows_cases : posix_cases;

#endif
